/**
* Jenkins Doc: https://jenkins.io/doc/
*
**/

openshift.withCluster() {
  env.NAMESPACE = "appmod-twas"
  env.APP_NAME = "${JOB_NAME}".replaceAll(/-build.*/, '')
  echo "Starting Pipeline for ${APP_NAME}..."
}

pipeline {
    agent {
      label "maven"
    }
    stages {
        stage("Deploy objects") {
                  steps {
                    script {
                      openshift.withCluster() {
                        openshift.withProject() {
                          def objects1 = openshift.apply( readFile("Deployment/openshift/yaml/ssc.yaml"))
                          println "Created objects: ${objects1.names()}"
                          def objects2 = openshift.apply( readFile("Deployment/openshift/yaml/dc.yaml"), "--namespace=appmod-twas" )
                          println "Created objects: ${objects2.names()}"
                        }
                      }
                    }
                  }
                }  
              }
            }
